@model ComplianceAuditWeb.Models.AllocateActandRuleViewModel

@{
    /**/

    ViewBag.Title = "Add Acts Page";
}

<ul class="breadcrumb ML15">
    <li><a href="">Compliance Management</a></li>
    <li>SME Dashbord</li>
</ul>
<h2 class="ML15">SME Dashborad</h2>

@section scripts{
    <script language="javascript" type="text/javascript">
        function GetBranch(_CompanyId) {
            var procemessage = "<option value='0'> Please wait...</option>";
            $("#BranchId").html(procemessage).show();
            var url = "/Common/getspecificbranch";

            $.ajax({
                url: url,
                data: { compid: _CompanyId },
                cache: false,
                type: "POST",
                success: function (data) {
                    var markup = "<option value='0'>Select Branch</option>";
                    for (var x = 0; x < data.length; x++) {
                        markup += "<option value=" + data[x].Value + ">" + data[x].Text + "</option>";
                    }
                    $("#BranchId").html(markup).show();
                    $('#branchtbl').html(data);
                },
                error: function (reponse) {
                    alert("error : " + reponse);
                }
            });

        }

        function Getvendor(_CompanyId) {
            var procemessage = "<option value='0'> Please wait...</option>";
            $("#BranchId").html(procemessage).show();
            var url = "/Common/getspecificvendors";

            $.ajax({
                url: url,
                data: { compid: _CompanyId },
                cache: false,
                type: "POST",
                success: function (data) {
                    var markup = "<option value='0'>Select Branch</option>";
                    for (var x = 0; x < data.length; x++) {
                        markup += "<option value=" + data[x].Value + ">" + data[x].Text + "</option>";
                    }
                    $("#BranchId").html(markup).show();                 
                },
                error: function (reponse) {
                    alert("error : " + reponse);
                }
            });      
        }
        function AssignRule(_branchId) {
            var url = "/ComplianceManagement/AssignRules";
            $.ajax({
                url: url,
                data: { Branchid: _branchId },
                cache: false,
                type: "POST",
                success: function () {
                },
                error: function (reponse) {
                    alert("error : " + reponse);
                }
            });

        }
    </script>


}
@using (Html.BeginForm())
{
    <div class="mid_content_sec">
        <div class="col-xs-8 subSelect ">
            <div class="input-field">
                @Html.Label("Company", new { @class = "floating-label" })
                @Html.DropDownListFor(model => model.CompanyId, Model.Companylist, new { @class = "inputMaterial ui - autocomplete - input", @onchange = "GetBranch(this.value), Getvendor(this.value)" })
            </div>
        </div>
            <div class="clearfix"></div>
           
        <div class="col-xs-6 subSelect ">
            <div class="input-field">
                <table id="branchtbl">
                    @*<tr>
                        <th>
                            @Html.Label("List of Branch", new { @class = "floating-label" })
                        </th>
                    </tr>
                    @foreach (var item in ViewBag.Branch)
                    {
                        <tr>
                            <td>
                                <a href=@Url.Action("AssignRules", "ComplianceManagement", new { Branchid = item.Value })>
                                   item.text
                                </a>
                                @Html.ActionLink(item.Company_Name, "AssignRules",new { Branchid=item.Org_Hier_ID },null)                              
                            </td>
                        </tr>
                    }*@
                </table>
                
                @Html.DropDownListFor(model => model.BranchId, Model.BranchList, new { @class = "inputMaterial ui - autocomplete - input",@onchange = "AssignRule(this.value)" })
            </div>
        </div>
    <div class="col-xs-6 subSelect ">
        <div class="input-field">
            @Html.Label("List of Vendor", new { @class = "floating-label" })
            @Html.DropDownListFor(model => model.VendorId, Model.VendorList, new { @class = "inputMaterial ui - autocomplete - input", @onchange = "AssignRule(this.value)" })
        </div>
    </div>
            
    </div>
}